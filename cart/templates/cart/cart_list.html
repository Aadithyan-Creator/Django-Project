{% if items %}
<a href="{% url 'cart_checkout' %}" class="btn btn-success mb-3">Checkout</a>

<table class="table table-striped table-bordered">
  <thead class="table-dark">
    <tr>
      <th>ID</th>
      <th>Product</th>
      <th>Quantity</th>
      <th>Price</th>
      <th>Total</th>
      <th>Actions</th>
    </tr>
  </thead>
  <tbody>
    {% for item in items %}
    <tr>
      <td>{{ item.id }}</td>
      <td>{{ item.product.name }}</td>
      <td>{{ item.quantity }}</td>
      <td>₹{{ item.price|floatformat:2 }}</td>
      <td>₹{{ item.subtotal|floatformat:2 }}</td>
      <td>
        <a href="{% url 'cart_update' item.id %}" class="btn btn-primary btn-sm">Edit</a>
        <a href="{% url 'cart_delete' item.id %}" class="btn btn-danger btn-sm">Delete</a>
      </td>
    </tr>
    {% endfor %}
  </tbody>
</table>

<h5>Total: ₹{{ total|floatformat:2 }}</h5>
<h5>Discounted Total: ₹{{ discounted_total|floatformat:2 }}</h5>

<form method="POST" class="mt-3">
  {% csrf_token %}
  <input type="text" name="coupon_code" placeholder="Enter Coupon Code" class="form-control w-25 d-inline">
  <button type="submit" class="btn btn-dark">Apply</button>
</form>

{% if discount_applied %}
<p class="text-success mt-2">Coupon applied successfully.</p>
{% elif invalid_coupon %}
<p class="text-danger mt-2">Invalid or inactive coupon code.</p>
{% endif %}

{% else %}
<p>No items in cart.</p>
{% endif %}
